{% extends "base.html" %}

{% block title %}WiFi Setup - photos.local{% endblock %}

{% block content %}
<div class="setup-wizard">
    <div class="step-indicator">
        <span class="step active">1. WiFi</span>
        <span class="step">2. Google</span>
        <span class="step">3. Photos</span>
    </div>

    <h2>Connect to WiFi</h2>
    <p>Select your home WiFi network to connect the photo frame.</p>

    <form method="POST" action="{{ url_for('setup_wifi') }}" class="setup-form">
        <div class="form-group">
            <label for="ssid">WiFi Network</label>
            {% if networks %}
            <select name="ssid" id="ssid-select" onchange="toggleCustomSsid(this)">
                <option value="">Select a network...</option>
                {% for network in networks %}
                <option value="{{ network.ssid }}">
                    {{ network.ssid }} ({{ network.signal }}%) {% if network.security != 'Open' %}ðŸ”’{% endif %}
                </option>
                {% endfor %}
                <option value="__custom__">Enter manually...</option>
            </select>
            <input type="text" name="ssid_custom" id="ssid-custom" placeholder="Network name" style="display: none;">
            {% else %}
            <input type="text" name="ssid" id="ssid" placeholder="Enter WiFi network name" required>
            <p class="help-text">No networks found. Enter your network name manually.</p>
            {% endif %}
        </div>

        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" name="password" id="password" placeholder="WiFi password">
            <p class="help-text">Leave empty for open networks.</p>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Connect</button>
            <button type="button" class="btn btn-secondary" onclick="location.reload()">Scan Again</button>
        </div>
    </form>
</div>

<script>
function toggleCustomSsid(select) {
    const customInput = document.getElementById('ssid-custom');
    if (select.value === '__custom__') {
        customInput.style.display = 'block';
        customInput.name = 'ssid';
        select.name = 'ssid_select';
        customInput.required = true;
        customInput.focus();
    } else {
        customInput.style.display = 'none';
        customInput.name = 'ssid_custom';
        select.name = 'ssid';
        customInput.required = false;
    }
}
</script>
{% endblock %}
