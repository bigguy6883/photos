{% extends "base.html" %}

{% block title %}Slideshow Settings - photos.local{% endblock %}

{% block content %}
<div class="dashboard">
    <section class="status-section">
        <h2>Status</h2>
        <div class="status-grid">
            <div class="status-item">
                <span class="label">Photos</span>
                <span class="value">{{ cache_stats.count }}</span>
            </div>
            <div class="status-item">
                <span class="label">Cache Size</span>
                <span class="value">{{ cache_stats.size_mb }} MB</span>
            </div>
            <div class="status-item">
                <span class="label">Slideshow</span>
                <span class="value {% if status.running %}running{% else %}stopped{% endif %}">
                    {{ 'Running' if status.running else 'Stopped' }}
                </span>
            </div>
            <div class="status-item">
                <span class="label">Google Photos</span>
                <span class="value {% if settings.google.authenticated %}connected{% else %}disconnected{% endif %}">
                    {{ 'Connected' if settings.google.authenticated else 'Not Connected' }}
                </span>
            </div>
        </div>
    </section>

    <section class="controls-section">
        <h2>Photo Controls</h2>
        <div class="button-row">
            <form method="POST" action="{{ url_for('prev_photo') }}" style="display: inline;">
                <button type="submit" class="btn btn-secondary">Previous</button>
            </form>
            <form method="POST" action="{{ url_for('next_photo') }}" style="display: inline;">
                <button type="submit" class="btn btn-secondary">Next</button>
            </form>
            <a href="{{ url_for('show_info') }}" class="btn btn-secondary">Show Info</a>
        </div>

        <div class="button-row">
            {% if status.running %}
            <form method="POST" action="{{ url_for('stop_slideshow') }}" style="display: inline;">
                <button type="submit" class="btn btn-warning">Stop Slideshow</button>
            </form>
            {% else %}
            <form method="POST" action="{{ url_for('start_slideshow') }}" style="display: inline;">
                <button type="submit" class="btn btn-primary">Start Slideshow</button>
            </form>
            {% endif %}
        </div>
    </section>

    <section class="settings-section">
        <h2>Slideshow Settings</h2>
        <form method="POST" action="{{ url_for('update_settings') }}" class="settings-form">
            <div class="form-group">
                <label for="interval_minutes">Photo Interval</label>
                <select name="interval_minutes" id="interval_minutes">
                    {% for interval in interval_options %}
                    <option value="{{ interval }}" {% if settings.slideshow.interval_minutes == interval %}selected{% endif %}>
                        {% if interval < 60 %}
                            {{ interval }} minutes
                        {% elif interval == 60 %}
                            1 hour
                        {% elif interval < 1440 %}
                            {{ interval // 60 }} hours
                        {% else %}
                            24 hours
                        {% endif %}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="order">Photo Order</label>
                <select name="order" id="order">
                    <option value="random" {% if settings.slideshow.order == 'random' %}selected{% endif %}>Random</option>
                    <option value="sequential" {% if settings.slideshow.order == 'sequential' %}selected{% endif %}>Sequential</option>
                </select>
            </div>

            <h2>Display Settings</h2>

            <div class="form-group">
                <label for="fit_mode">Photo Fit Mode</label>
                <select name="fit_mode" id="fit_mode">
                    <option value="contain" {% if settings.display.fit_mode == 'contain' %}selected{% endif %}>
                        Contain (fit with bars)
                    </option>
                    <option value="cover" {% if settings.display.fit_mode == 'cover' %}selected{% endif %}>
                        Cover (fill with crop)
                    </option>
                    <option value="stretch" {% if settings.display.fit_mode == 'stretch' %}selected{% endif %}>
                        Stretch (may distort)
                    </option>
                </select>
            </div>

            <div class="form-group">
                <label for="orientation">Orientation</label>
                <select name="orientation" id="orientation">
                    <option value="horizontal" {% if settings.display.orientation == 'horizontal' %}selected{% endif %}>
                        Horizontal (Landscape)
                    </option>
                    <option value="vertical" {% if settings.display.orientation == 'vertical' %}selected{% endif %}>
                        Vertical (Portrait)
                    </option>
                </select>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Save Settings</button>
            </div>
        </form>
    </section>

    <section class="management-section">
        <h2>Photo Management</h2>
        <div class="button-row">
            <a href="{{ url_for('setup_album') }}" class="btn btn-secondary">
                Select More Photos
            </a>
        </div>

        <div class="button-row danger-zone">
            <form method="POST" action="{{ url_for('clear_cache') }}"
                  onsubmit="return confirm('Delete all cached photos?')">
                <button type="submit" class="btn btn-danger">Clear Photo Cache</button>
            </form>

            <form method="POST" action="{{ url_for('disconnect_google') }}"
                  onsubmit="return confirm('Disconnect from Google Photos?')">
                <button type="submit" class="btn btn-danger">Disconnect Google</button>
            </form>
        </div>
    </section>
</div>
{% endblock %}
